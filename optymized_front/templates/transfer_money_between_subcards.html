{% extends "base.html" %}


{% block title %}–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –ø–æ–¥–∫–∞—Ä—Ç–∞–º–∏{% endblock %}

{% block content %}


<h1> üí≥ –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h1>

<form method="post">
<div class="item">
<div class="item">

    <select name="card_from" id="card-select-from">
        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –æ—Ç–∫—É–¥–∞ --</option>
        {% for card in cards %}
            <option value="{{ card.card_id }}">{{ card.card_name }}</option>
        {% endfor %}
    </select>

    <select name="category_from" id="category-select-from" disabled>
        <option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É --</option>
    </select>

</div>

<div class="item">

    <select name="card_to" id="card-select-to">
        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É –∫—É–¥–∞--</option>
        {% for card in cards %}
            <option value="{{ card.card_id }}">{{ card.card_name }}</option>
        {% endfor %}
    </select>
    
    <select name="category_to" id="category-select-to" disabled>
        <option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É --</option>
    </select>
    
</div>


    
        <label>–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞:</label>
        <input type="number" name="money_amount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" required>
      
    
        <button style="margin-top: 10px;" type="submit">‚ûï –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å </button>
</div>
</form>



<script>
    // –ü–µ—Ä–µ–¥–∞—ë–º —Å–ª–æ–≤–∞—Ä—å –∏–∑ Flask –≤ JavaScript
    const cardToCategories = {{ card_to_categories | tojson }};
    
    document.getElementById('card-select-from').addEventListener('change', function () {
        const cardId = this.value;
        const categorySelect = document.getElementById('category-select-from');
    
        if (!cardId) {
            categorySelect.innerHTML = '<option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É --</option>';
            categorySelect.disabled = true;
            return;
        }
        

        const categories = cardToCategories[cardId] || [];

        if (categories.length === 0) {
            categorySelect.innerHTML = '<option value="">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</option>';
            categorySelect.disabled = false;
            return;
        }
    
        let options = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é --</option>';
        categories.forEach(cat => {
            options += `<option value="${cat.category_id}">${cat.category_name}</option>`;
        });
    
        categorySelect.innerHTML = options;
        categorySelect.disabled = false;
    });

    document.getElementById('card-select-to').addEventListener('change', function () {
        const cardId = this.value;
        const categorySelect = document.getElementById('category-select-to');
    
        if (!cardId) {
            categorySelect.innerHTML = '<option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É --</option>';
            categorySelect.disabled = true;
            return;
        }
        

        const categories = cardToCategories[cardId] || [];

        if (categories.length === 0) {
            categorySelect.innerHTML = '<option value="">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π</option>';
            categorySelect.disabled = false;
            return;
        }
    
        let options = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é --</option>';
        categories.forEach(cat => {
            options += `<option value="${cat.category_id}">${cat.category_name}</option>`;
        });
    
        categorySelect.innerHTML = options;
        categorySelect.disabled = false;
    });
    </script>




{% endblock %}